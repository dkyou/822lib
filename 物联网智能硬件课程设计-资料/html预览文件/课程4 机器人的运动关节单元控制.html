<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>课程4 机器人的运动关节单元控制</title>
  <link rel="stylesheet" href="https://stackedit.io/style.css" />
</head>

<body class="stackedit">
  <div class="stackedit__html"><h1><a id="4__1"></a>课程4 机器人的运动关节单元控制</h1>
<h2><a id="_2"></a>课程概述</h2>
<p>在这个教程中，我们将学通过习树莓派GPIO控制外部舵机。</p>
<h2><a id="_4"></a>关于课程</h2>
<p>按照规划，本课程需要花费大约60分钟来完成，目标受众为四足机器人开发爱好者。<br>
<strong>note</strong><br>
本课程是基于<a href="https://www.mangdang.net/">Mangdang</a>的Mini Pupper系列产品搭建的。<br>
本课程涉及的源代码托管在Github，你可以<a href="https://github.com/mangdangroboticsclub/mini_pupper_ros/tree/ros2">点击此处访问</a>。</p>
<h2><a id="_9"></a>学习目标</h2>
<p>在完成这个教程后，你将能够：</p>
<ol>
<li>通过背景知识学习，了解舵机的外观及基本运动方式。</li>
<li>了解四足机器人mini pupper腿部单个舵机的组成结构。</li>
<li>通过GPIO对舵机进行转动控制，熟悉PWM。</li>
<li>了解mini pupper舵机组的整体调零。</li>
</ol>
<h2><a id="_16"></a>课程细节</h2>
<p>本课程将使用树莓派GPIO控制Mangdang定制舵机。</p>
<h2><a id="_19"></a>准备材料</h2>
<p>在开始这个教程之前，你需要准备以下材料：</p>
<ul>
<li>一台安装了Python的树莓派4B</li>
<li>Mangdang定制舵机</li>
<li>若干杜邦线</li>
</ul>
<h1><a id="_24"></a>引言</h1>
<p>在这个教程中，我们将学习如何使用Python语言编程，在编程中使用PWM方法，通过树莓派GPIO控制外部舵机来回摆动，角度范围为0°~180°，周期为四秒。</p>
<h2><a id="_26"></a>整体步骤</h2>
<p>这个教程将分为几个任务：<br>
1.学习基本知识<br>
2.编写Python程序 servo_PWM_GPIO.py<br>
3.运行程序servo_PWM_GPIO.py并观察效果<br>
4. 尝试运行Python程序 servo_PWM_GPIO_2.py[可选]</p>
<p>请按照教程中的步骤完成每个任务。</p>
<h1><a id="1_34"></a>任务1：学习基本知识</h1>
<h3><a id="1__35"></a>1. 什么是舵机？</h3>
<p>舵机（servomotor）是一种简化版本的伺服电机，是位置伺服的驱动器，能够通过输入PWM信号控制旋转角度，具备轻量、小型、简化和性价比高的特点。<br>
舵机适用于那些需要角度不断变化并可以保持的简单控制系统，它能实现较为精确的电机控制，在航模、遥控玩具、机器狗等品类上运用良好。<br>
<img src="https://img-blog.csdnimg.cn/88635d9bc7174ea4bde6b0e04adb5dd4.jpeg" alt="在这里插入图片描述"></p>
<p><strong>图片1：舵机的外观</strong></p>
<h3><a id="2__42"></a>2. 舵机的运动方式</h3>
<p>舵机的运动方式是绕轴摆动，“舵机”一词也和它的运动方式有关，舵机常用来摆动调整方向，就像海洋上的水手的舵一样，航模和船模常常用舵机的摆动来调整一些零部件的角度。</p>
<p><strong>图片2：舵机的运动动图</strong></p>
<h3><a id="3__47"></a>3. 舵机的组成结构</h3>
<p>舵机一般是由保护外壳、内部集成控制芯片、小型直流电机、减速器齿轮组、位置检测单元构成的。</p>
<p>当主控给舵机发出转动信号时，控制芯片驱动电机开始转动，通过减速器将动力传达到输出轴上的摆臂，由位置检测单元反馈转动结果信号给主控进行反馈调节。<br>
一般来说，位置检测单元可以是可变电阻，当舵机转动时，可变电阻随之改变，由此可得转动的角度信息。舵机包含了电机、传感器和控制器，是一个集成度高的、完整的伺服电机系统。<br>
<img src="https://img-blog.csdnimg.cn/fd87bfa9017a4152b5b84c436153ae9d.jpeg" alt="在这里插入图片描述"></p>
<p><strong>图片2：舵机的内部结构拍摄</strong></p>
<h3><a id="4_mini_pupper_59"></a>4. mini pupper定制舵机的部分硬件参数</h3>
<p>芒砀科技MANGDANG针对mini pupper的运动需求，在原型舵机的基础上优化改进了机械结构，定制了mini pupper专用舵机，这使得mini pupper的控制更加精确、动力更加澎湃。<br>
<img src="https://img-blog.csdnimg.cn/8f0f387baf1e40ebb1289070ae5377f2.png" alt="在这里插入图片描述"><br>
<strong>图片3：Mangdang定制舵机</strong></p>
<p><strong>参考文件：mini pupper定制电机规格书 课程附件 MiniPupper-Servo-Spec.pdf</strong><br>
你可以在课程附件里找到这个规格书</p>
<h3><a id="5mini_pupper_68"></a>5.mini pupper舵机的控制方法</h3>
<p>对于舵机的控制，首先要了解其基本硬件参数以及舵机对信号通讯的要求。<br>
如图所示，mini pupper一代舵机允许PWM的直接使用，也就是说，舵机可以直接连接到树莓派上的GPIO_PWM端口使用而不需要考虑通讯协议，这对机器人入门开发者来说较为友好。</p>
<pre><code class="prism language-bash">servo_SIG <span class="token operator">=</span> <span class="token number">32</span>  <span class="token comment"># 1</span>
servo_VCC <span class="token operator">=</span> <span class="token number">4</span>  <span class="token comment"># 2</span>
servo_GND <span class="token operator">=</span> <span class="token number">6</span>  <span class="token comment"># 3</span>
<span class="token comment"># 1,2,3 in picture below</span>
</code></pre>
<p><img src="https://img-blog.csdnimg.cn/7345348c27aa4cd481d70d7c3fda2e17.png" alt="在这里插入图片描述"><br>
<strong>图片4：舵机端口的连线</strong></p>
<h4><a id="mini_pupper_82"></a>mini pupper一代舵机部分参数表</h4>

<table>
<thead>
<tr>
<th>name</th>
<th>value</th>
</tr>
</thead>
<tbody>
<tr>
<td>端口1(黄)</td>
<td>PWM Signal</td>
</tr>
<tr>
<td>端口2(红)</td>
<td>Vcc 4.8v~6v</td>
</tr>
<tr>
<td>端口3 (棕)</td>
<td>GND</td>
</tr>
<tr>
<td>信号周期</td>
<td>20ms</td>
</tr>
<tr>
<td>信号频率</td>
<td>50HZ</td>
</tr>
<tr>
<td>脉冲长度范围</td>
<td>500us-2500us to 0°~180°</td>
</tr>
<tr>
<td>脉冲长度对应占空比</td>
<td>2.5% - 12.5%</td>
</tr>
<tr>
<td>信号高电平范围</td>
<td>2V-5V</td>
</tr>
<tr>
<td>信号低电平范围</td>
<td>0.0V-0.45V</td>
</tr>
<tr>
<td>中间位对应脉冲</td>
<td>1500 μsec</td>
</tr>
</tbody>
</table><p>需要注意的是：<br>
占空比=脉宽/周期<br>
脉宽500us-2500us对应的占空比为2.5% - 12.5%</p>
<h3><a id="6_RPiGPIOPWM_100"></a>6. RPi的GPIO库中PWM的用法</h3>
<pre><code class="prism language-python"><span class="token keyword">import</span> RPi<span class="token punctuation">.</span>GPIO <span class="token keyword">as</span> GPIO	<span class="token comment">#	引入GPIO库</span>
</code></pre>
<pre><code class="prism language-python">GPIO<span class="token punctuation">.</span>setmode<span class="token punctuation">(</span>GPIO<span class="token punctuation">.</span>BOARD<span class="token punctuation">)</span> <span class="token comment">#初始化GPIO引脚编码方式，需放在代码正式开始处</span>
GPIO<span class="token punctuation">.</span>setup<span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span> GPIO<span class="token punctuation">.</span>OUT<span class="token punctuation">)</span> <span class="token comment">#初始化GPIO引脚设置，需放在代码正式开始处</span>
</code></pre>
<pre><code class="prism language-python">p <span class="token operator">=</span> GPIO<span class="token punctuation">.</span>PWM<span class="token punctuation">(</span>channel<span class="token punctuation">,</span> frequency<span class="token punctuation">)</span>	<span class="token comment">#	创建pwm实例 channel为引脚号 frequency为频率</span>
</code></pre>
<pre><code class="prism language-python">p<span class="token punctuation">.</span>start<span class="token punctuation">(</span>dc<span class="token punctuation">)</span>	<span class="token comment">#	开始pwm	dc为初始占空比(0.0 &lt;= dc &lt;= 100.0)</span>
</code></pre>
<pre><code class="prism language-python">p<span class="token punctuation">.</span>stop<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 停止pwm</span>
</code></pre>
<pre><code class="prism language-python">p<span class="token punctuation">.</span>ChangeFrequency<span class="token punctuation">(</span>freq<span class="token punctuation">)</span>   <span class="token comment"># 改变频率（Hz）freq</span>
</code></pre>
<pre><code class="prism language-python">p<span class="token punctuation">.</span>ChangeDutyCycle<span class="token punctuation">(</span>dc<span class="token punctuation">)</span>  <span class="token comment"># 改变占空比(0.0 &lt;= dc &lt;= 100.0)</span>
</code></pre>
<pre><code class="prism language-python">GPIO<span class="token punctuation">.</span>cleanup<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 清理GPIO引脚</span>
</code></pre>
<p><a href="https://sourceforge.net/p/raspberry-gpio-python/wiki/PWM/">参考链接：RPi GPIO库中PWM()函数的详细资料</a></p>
<h1><a id="2Python_servo_PWM_GPIOpy_136"></a>任务2：编写Python程序 servo_PWM_GPIO.py</h1>
<pre><code class="prism language-python"><span class="token comment">#!/usr/bin/python</span>
<span class="token comment"># coding:utf-8</span>
<span class="token comment"># servo_PWM_GPIO.py</span>
<span class="token comment"># 树莓派GPIO控制外部舵机来回摆动，角度范围为0~180°，周期为4秒。</span>
<span class="token keyword">try</span><span class="token punctuation">:</span>
    <span class="token keyword">import</span> RPi<span class="token punctuation">.</span>GPIO <span class="token keyword">as</span> GPIO
<span class="token keyword">except</span> RuntimeError<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Error importing RPi.GPIO!  This is probably because you need superuser privileges. "</span>
          <span class="token string">" You can achieve this by using 'sudo' to run your script"</span><span class="token punctuation">)</span>
<span class="token keyword">import</span> time


<span class="token keyword">def</span> <span class="token function">servo_map</span><span class="token punctuation">(</span>before_value<span class="token punctuation">,</span> before_range_min<span class="token punctuation">,</span> before_range_max<span class="token punctuation">,</span> after_range_min<span class="token punctuation">,</span> after_range_max<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    功能:将某个范围的值映射为另一个范围的值
    参数：原范围某值，原范围最小值，原范围最大值，变换后范围最小值，变换后范围最大值
    返回：变换后范围对应某值
    """</span>
    percent <span class="token operator">=</span> <span class="token punctuation">(</span>before_value <span class="token operator">-</span> before_range_min<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token punctuation">(</span>before_range_max <span class="token operator">-</span> before_range_min<span class="token punctuation">)</span>
    after_value <span class="token operator">=</span> after_range_min <span class="token operator">+</span> percent <span class="token operator">*</span> <span class="token punctuation">(</span>after_range_max <span class="token operator">-</span> after_range_min<span class="token punctuation">)</span>
    <span class="token keyword">return</span> after_value


GPIO<span class="token punctuation">.</span>setmode<span class="token punctuation">(</span>GPIO<span class="token punctuation">.</span>BOARD<span class="token punctuation">)</span>  <span class="token comment"># 初始化GPIO引脚编码方式</span>
servo_SIG <span class="token operator">=</span> <span class="token number">32</span>
servo_VCC <span class="token operator">=</span> <span class="token number">4</span>
servo_GND <span class="token operator">=</span> <span class="token number">6</span>
servo_freq <span class="token operator">=</span> <span class="token number">50</span>
servo_time <span class="token operator">=</span> <span class="token number">0.01</span>
servo_width_min <span class="token operator">=</span> <span class="token number">2.5</span>
servo_width_max <span class="token operator">=</span> <span class="token number">12.5</span>
<span class="token comment"># servo_degree_div =servo_width_max - servo_width_min)/180</span>
GPIO<span class="token punctuation">.</span>setup<span class="token punctuation">(</span>servo_SIG<span class="token punctuation">,</span> GPIO<span class="token punctuation">.</span>OUT<span class="token punctuation">)</span>
<span class="token comment"># 如果你需要忽视引脚复用警告，请调用GPIO.setwarnings(False)</span>
<span class="token comment"># GPIO.setwarnings(False)</span>
servo <span class="token operator">=</span> GPIO<span class="token punctuation">.</span>PWM<span class="token punctuation">(</span>servo_SIG<span class="token punctuation">,</span> servo_freq<span class="token punctuation">)</span>  <span class="token comment"># 信号引脚=servo_SIG 频率=servo_freq in HZ</span>
servo<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
servo<span class="token punctuation">.</span>ChangeDutyCycle<span class="token punctuation">(</span><span class="token punctuation">(</span>servo_width_min<span class="token operator">+</span>servo_width_max<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span>  <span class="token comment"># 回归舵机中位</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'预设置完成，两秒后开始摆动'</span><span class="token punctuation">)</span>
time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token keyword">try</span><span class="token punctuation">:</span>  <span class="token comment"># try和except为固定搭配，用于捕捉执行过程中，用户是否按下ctrl+C终止程序</span>
    <span class="token keyword">while</span> <span class="token number">1</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> dc <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">181</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            dc_trans <span class="token operator">=</span> servo_map<span class="token punctuation">(</span>dc<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">180</span><span class="token punctuation">,</span> servo_width_min<span class="token punctuation">,</span> servo_width_max<span class="token punctuation">)</span>
            servo<span class="token punctuation">.</span>ChangeDutyCycle<span class="token punctuation">(</span>dc_trans<span class="token punctuation">)</span>
            <span class="token comment"># print(dc_trans)</span>
            time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span>servo_time<span class="token punctuation">)</span>
        time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.2</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> dc <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">180</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            dc_trans <span class="token operator">=</span> servo_map<span class="token punctuation">(</span>dc<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">180</span><span class="token punctuation">,</span> servo_width_min<span class="token punctuation">,</span> servo_width_max<span class="token punctuation">)</span>
            servo<span class="token punctuation">.</span>ChangeDutyCycle<span class="token punctuation">(</span>dc_trans<span class="token punctuation">)</span>
            <span class="token comment"># print(dc_trans)</span>
            time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span>servo_time<span class="token punctuation">)</span>
        time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.2</span><span class="token punctuation">)</span>
<span class="token keyword">except</span> KeyboardInterrupt<span class="token punctuation">:</span>
    <span class="token keyword">pass</span>
servo<span class="token punctuation">.</span>stop<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 停止pwm</span>
GPIO<span class="token punctuation">.</span>cleanup<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 清理GPIO引脚</span>
</code></pre>
<h1><a id="3servo_PWM_GPIOpy_198"></a>任务3：运行程序servo_PWM_GPIO.py并观察效果</h1>
<p>在servo_PWM_GPIO.py的目录下执行以下命令：</p>
<pre><code class="prism language-bash"><span class="token function">sudo</span> python servo_PWM_GPIO.py
</code></pre>
<p>此时应观察到舵机在树莓派的控制下来回摆动，角度范围为0°~180°，周期为四秒。</p>
<h1><a id="4Python_servo_PWM_GPIO_2py_205"></a>任务4：尝试运行Python程序 servo_PWM_GPIO_2.py[可选]</h1>
<pre><code class="prism language-python"><span class="token comment">#!/usr/bin/python</span>
<span class="token comment"># coding:utf-8</span>
<span class="token comment"># servo_PWM_GPIO_2.py</span>
<span class="token comment"># 输入一个角度值，舵机将转动到对应的角度</span>
<span class="token keyword">try</span><span class="token punctuation">:</span>
    <span class="token keyword">import</span> RPi<span class="token punctuation">.</span>GPIO <span class="token keyword">as</span> GPIO
<span class="token keyword">except</span> RuntimeError<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Error importing RPi.GPIO!  This is probably because you need superuser privileges. "</span>
          <span class="token string">" You can achieve this by using 'sudo' to run your script"</span><span class="token punctuation">)</span>
<span class="token keyword">import</span> time


<span class="token keyword">def</span> <span class="token function">servo_map</span><span class="token punctuation">(</span>before_value<span class="token punctuation">,</span> before_range_min<span class="token punctuation">,</span> before_range_max<span class="token punctuation">,</span> after_range_min<span class="token punctuation">,</span> after_range_max<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    功能:将某个范围的值映射为另一个范围的值
    参数：原范围某值，原范围最小值，原范围最大值，变换后范围最小值，变换后范围最大值
    返回：变换后范围对应某值
    """</span>
    percent <span class="token operator">=</span> <span class="token punctuation">(</span>before_value <span class="token operator">-</span> before_range_min<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token punctuation">(</span>before_range_max <span class="token operator">-</span> before_range_min<span class="token punctuation">)</span>
    after_value <span class="token operator">=</span> after_range_min <span class="token operator">+</span> percent <span class="token operator">*</span> <span class="token punctuation">(</span>after_range_max <span class="token operator">-</span> after_range_min<span class="token punctuation">)</span>
    <span class="token keyword">return</span> after_value


GPIO<span class="token punctuation">.</span>setmode<span class="token punctuation">(</span>GPIO<span class="token punctuation">.</span>BOARD<span class="token punctuation">)</span>  <span class="token comment"># 初始化GPIO引脚编码方式</span>
servo_SIG <span class="token operator">=</span> <span class="token number">32</span>
servo_VCC <span class="token operator">=</span> <span class="token number">4</span>
servo_GND <span class="token operator">=</span> <span class="token number">6</span>
servo_freq <span class="token operator">=</span> <span class="token number">50</span>
servo_time <span class="token operator">=</span> <span class="token number">0.01</span>
servo_width_min <span class="token operator">=</span> <span class="token number">2.5</span>
servo_width_max <span class="token operator">=</span> <span class="token number">12.5</span>
<span class="token comment"># servo_degree_div =servo_width_max - servo_width_min)/180</span>
GPIO<span class="token punctuation">.</span>setup<span class="token punctuation">(</span>servo_SIG<span class="token punctuation">,</span> GPIO<span class="token punctuation">.</span>OUT<span class="token punctuation">)</span>
<span class="token comment"># 如果你需要忽视引脚复用警告，请调用GPIO.setwarnings(False)</span>
<span class="token comment"># GPIO.setwarnings(False)</span>
servo <span class="token operator">=</span> GPIO<span class="token punctuation">.</span>PWM<span class="token punctuation">(</span>servo_SIG<span class="token punctuation">,</span> servo_freq<span class="token punctuation">)</span>  <span class="token comment"># 信号引脚=servo_SIG 频率=servo_freq in HZ</span>
servo<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
servo<span class="token punctuation">.</span>ChangeDutyCycle<span class="token punctuation">(</span><span class="token punctuation">(</span>servo_width_min<span class="token operator">+</span>servo_width_max<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span>  <span class="token comment"># 回归舵机中位</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'预设置完成，两秒后开始等待输入'</span><span class="token punctuation">)</span>
time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token comment"># 为舵机指定位置</span>
<span class="token keyword">try</span><span class="token punctuation">:</span>    <span class="token comment"># try和except为固定搭配，用于捕捉执行过程中，用户是否按下ctrl+C终止程序</span>
    <span class="token keyword">while</span> <span class="token number">1</span><span class="token punctuation">:</span>
        position <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"请输入0°-180°的角度值：\n"</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> position<span class="token punctuation">.</span>isdigit<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">:</span>
            dc <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>position<span class="token punctuation">)</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>dc<span class="token operator">&gt;=</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token punctuation">(</span>dc<span class="token operator">&lt;=</span><span class="token number">180</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                dc_trans<span class="token operator">=</span>servo_map<span class="token punctuation">(</span>dc<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">180</span><span class="token punctuation">,</span>servo_width_min<span class="token punctuation">,</span>servo_width_max<span class="token punctuation">)</span>
                servo<span class="token punctuation">.</span>ChangeDutyCycle<span class="token punctuation">(</span>dc_trans<span class="token punctuation">)</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"已转动到%d°处"</span><span class="token operator">%</span>dc<span class="token punctuation">)</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Error Input:Exceed Range"</span><span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Error Input:Not Int Input"</span><span class="token punctuation">)</span>
<span class="token keyword">except</span> KeyboardInterrupt<span class="token punctuation">:</span>
    <span class="token keyword">pass</span>

servo<span class="token punctuation">.</span>stop<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 停止pwm</span>
GPIO<span class="token punctuation">.</span>cleanup<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 清理GPIO引脚</span>
</code></pre>
<h2><a id="_268"></a>尝试整机调零[可选]</h2>
<p>为了确保控制精度，mini pupper上的舵机组通常在使用前先进行一次调零。<br>
在安装好mini_pupper_bsp包后，试试在命令行中运行图形化舵机调零程序calibrate</p>
<pre><code class="prism language-bash">calibrate  <span class="token comment"># this is a command</span>
</code></pre>
<p>如果希望了解校准的详细信息，你可以查看<a href="https://minipupperdocs.readthedocs.io/en/latest/guide/Software.html#step-2-1-leg-calibration-not-for-ros-image">mini pupper的官方文档：校准</a></p>
<p>确保 Mini Pupper 已预先组装好，使用GUI校准工具来优化腿部的位置。<br>
对于每条腿，移动杆，使所有腿都成 45 度角。 腿的角度会随着滑动条在屏幕上的位置而变化。<br>
如果它不动，则说明您执行的步骤不正确。<br>
您可以使用 iPhone 的倾斜传感器app、尺子或量角器来测量角度。</p>
<h1><a id="_281"></a>总结</h1>
<p>经过本知识点的学习和实验操作，你应该能达到以下水平：</p>

<table>
<thead>
<tr>
<th>知识点</th>
<th>内容</th>
<th>了解</th>
<th>熟悉</th>
<th>掌握</th>
</tr>
</thead>
<tbody>
<tr>
<td>舵机</td>
<td>舵机的外观及基本运动方式</td>
<td>✔</td>
<td></td>
<td></td>
</tr>
<tr>
<td>舵机</td>
<td>单个舵机的组成结构</td>
<td>✔</td>
<td></td>
<td></td>
</tr>
<tr>
<td>PWM</td>
<td>PWM方法对舵机进行转动控制</td>
<td></td>
<td>✔</td>
<td></td>
</tr>
<tr>
<td>调零与校准</td>
<td>mini pupper舵机组的调零与校准</td>
<td>✔</td>
<td></td>
<td></td>
</tr>
</tbody>
</table><h1><a id="_291"></a>背景信息和资源</h1>
<p>本教程基于以下资源编写：<br>
<a href="https://sourceforge.net/p/raspberry-gpio-python/wiki/PWM/">参考链接：RPi GPIO库中PWM()函数的详细资料</a><br>
<a href="https://minipupperdocs.readthedocs.io/en/latest/guide/Software.html#step-2-1-leg-calibration-not-for-ros-image">参考链接：mini pupper的官方文档：校准</a></p>
<p><strong>版权信息：教材尚未完善，此处预留版权信息处理方式</strong><br>
mini pupper相关内容可访问：<a href="https://github.com/mangdangroboticsclub">https://github.com/mangdangroboticsclub</a></p>
</div>
</body>

</html>
